{
  "generated": "2026-01-03T17:26:49.358Z",
  "count": 45,
  "rules": [
    {
      "id": "weather_rain",
      "category": "weather",
      "priority": 200,
      "headlineCondition": "weather_rain",
      "bodyFragmentTemplate": "Rain expected today. Wet conditions likely at lower elevations.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const temp = rawData.forecast?.today?.high_f; return hasRain(rawData) && temp !== null && temp >= 35; }"
    },
    {
      "id": "weather_mixed",
      "category": "weather",
      "priority": 195,
      "headlineCondition": "weather_mixed",
      "bodyFragmentTemplate": "Mixed precipitation expected. Rain at base, snow up top. Dress in layers.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => hasMixedPrecip(rawData)"
    },
    {
      "id": "snow_historic",
      "category": "snow",
      "priority": 100,
      "headlineCondition": "snow_historic",
      "bodyFragmentTemplate": "HISTORIC: {snow24h}\" overnight. This is a once-in-a-season event. Drop everything.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const snow24h = rawData.snow?.['24hour_inches'] || 0; const tier = getSnowTier(snow24h); return tier && tier.key === 'historic'; }"
    },
    {
      "id": "snow_epic",
      "category": "snow",
      "priority": 98,
      "headlineCondition": "snow_epic",
      "bodyFragmentTemplate": "EPIC: {snow24h}\" of fresh powder. Career day potential. First chair or regret it.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const snow24h = rawData.snow?.['24hour_inches'] || 0; const tier = getSnowTier(snow24h); return tier && tier.key === 'epic'; }"
    },
    {
      "id": "resort_closed",
      "category": "terrain",
      "priority": 95,
      "headlineCondition": "resort_closed",
      "bodyFragmentTemplate": null,
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; return openTrails === 0; }"
    },
    {
      "id": "snow_deep",
      "category": "snow",
      "priority": 95,
      "headlineCondition": "snow_deep",
      "bodyFragmentTemplate": "Deep day: {snow24h}\" overnight. Stashes are loaded, groomers are buried. Time to hunt.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const snow24h = rawData.snow?.['24hour_inches'] || 0; const tier = getSnowTier(snow24h); return tier && tier.key === 'deep'; }"
    },
    {
      "id": "terrain_massive",
      "category": "terrain",
      "priority": 95,
      "headlineCondition": "terrain_massive",
      "bodyFragmentTemplate": "MASSIVE expansion: {newTrailsCount} new {newTrailWord} opened. The floodgates are open.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const delta = rawData.terrain?.stats?.openTrails?.delta || 0; const tier = getTerrainTier(delta); return tier && tier.key === 'massive'; }"
    },
    {
      "id": "forecast_major_storm",
      "category": "weather",
      "priority": 92,
      "headlineCondition": "storm_major",
      "bodyFragmentTemplate": "MAJOR STORM incoming: {forecastSnowTotal}\" expected over the next few days. Clear your schedule.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const total = getForecastSnowTotal(rawData); const tier = getForecastTier(total); return tier && tier.key === 'major_storm'; }"
    },
    {
      "id": "snow_powder",
      "category": "snow",
      "priority": 90,
      "headlineCondition": "powder_alert",
      "bodyFragmentTemplate": "Powder alert: {snow24h}\" of fresh overnight means soft conditions across the mountain.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const snow24h = rawData.snow?.['24hour_inches'] || 0; const tier = getSnowTier(snow24h); return tier && tier.key === 'powder'; }"
    },
    {
      "id": "terrain_major",
      "category": "terrain",
      "priority": 88,
      "headlineCondition": "terrain_major",
      "bodyFragmentTemplate": "Major terrain drop: {newTrailsCount} new {newTrailWord} opened overnight.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const delta = rawData.terrain?.stats?.openTrails?.delta || 0; const tier = getTerrainTier(delta); return tier && tier.key === 'major'; }"
    },
    {
      "id": "forecast_storm",
      "category": "weather",
      "priority": 85,
      "headlineCondition": "storm_major",
      "bodyFragmentTemplate": "Storm building with {forecastSnowTotal}\" expected. Conditions about to improve.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const total = getForecastSnowTotal(rawData); const tier = getForecastTier(total); return tier && tier.key === 'storm'; }"
    },
    {
      "id": "temp_arctic",
      "category": "weather",
      "priority": 85,
      "headlineCondition": "cold_arctic",
      "bodyFragmentTemplate": "ARCTIC: {tempHigh}° for a high. Extreme cold - limit exposed skin and take warming breaks.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const temp = rawData.forecast?.today?.high_f; if (temp === null || temp === undefined) return false; const tier = getTempTier(temp); return tier && tier.key === 'arctic'; }"
    },
    {
      "id": "snow_solid",
      "category": "snow",
      "priority": 82,
      "headlineCondition": "snow_solid",
      "bodyFragmentTemplate": "Solid refresh: {snow24h}\" overnight freshened up the mountain. Groomers are smooth, off-piste is soft.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const snow24h = rawData.snow?.['24hour_inches'] || 0; const tier = getSnowTier(snow24h); return tier && tier.key === 'solid'; }"
    },
    {
      "id": "weather_storm_wind",
      "category": "weather",
      "priority": 82,
      "headlineCondition": "storm_wind",
      "bodyFragmentTemplate": "Active weather: snow and wind today. Visibility may be limited at times.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const desc = (rawData.forecast?.today?.description || '').toLowerCase(); return desc.includes('snow') && isWindy(rawData); }"
    },
    {
      "id": "lift_busy",
      "category": "lifts",
      "priority": 80,
      "headlineCondition": null,
      "bodyFragmentTemplate": "Heads up: {busiestLift} peaked at {maxWait} minutes yesterday. Consider alternatives.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { if (!isValidLiftData(rawData)) return false; return rawData.lifts?.yesterday?.maxWaitTime > 15; }"
    },
    {
      "id": "grooming_massive",
      "category": "terrain",
      "priority": 78,
      "headlineCondition": "grooming_massive",
      "bodyFragmentTemplate": "The snow cats went hard: {groomedCount} {groomedRunWord} of fresh corduroy across {zones}.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const count = rawData.terrain?.newlyGroomed?.length || 0; const tier = getGroomingTier(count); return tier && tier.key === 'massive'; }"
    },
    {
      "id": "terrain_expanding",
      "category": "terrain",
      "priority": 75,
      "headlineCondition": "terrain_expansion",
      "bodyFragmentTemplate": "Terrain expanding: {newTrailsCount} new {newTrailWord} opening up more options.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const delta = rawData.terrain?.stats?.openTrails?.delta || 0; const tier = getTerrainTier(delta); return tier && tier.key === 'expanding'; }"
    },
    {
      "id": "temp_frigid",
      "category": "weather",
      "priority": 73,
      "headlineCondition": "cold_snap",
      "bodyFragmentTemplate": "Frigid temps today: high of only {tempHigh}°. Layer up and take warming breaks.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const temp = rawData.forecast?.today?.high_f; if (temp === null || temp === undefined) return false; const tier = getTempTier(temp); return tier && tier.key === 'frigid'; }"
    },
    {
      "id": "grooming_excellent",
      "category": "terrain",
      "priority": 72,
      "headlineCondition": "grooming_highlight",
      "bodyFragmentTemplate": "{groomedCount} {groomedRunWord} {groomedWere} freshly groomed overnight. Smooth sailing in {zones}.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const count = rawData.terrain?.newlyGroomed?.length || 0; const tier = getGroomingTier(count); return tier && tier.key === 'excellent'; }"
    },
    {
      "id": "snow_dusting",
      "category": "snow",
      "priority": 70,
      "headlineCondition": "fresh_coat",
      "bodyFragmentTemplate": "Light dusting of {snow24h}\" overnight makes the hardpack a bit friendlier.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const snow24h = rawData.snow?.['24hour_inches'] || 0; const tier = getSnowTier(snow24h); return tier && tier.key === 'dusting'; }"
    },
    {
      "id": "weather_bluebird",
      "category": "weather",
      "priority": 70,
      "headlineCondition": "bluebird_day",
      "bodyFragmentTemplate": "Bluebird conditions: {tempHigh}° and clear. Bundle up for some crisp, beautiful turns.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const temp = rawData.forecast?.today?.high_f; if (temp === null || temp === undefined) return false; return isClearOrSunny(rawData) && temp <= 32 && temp > 10; }"
    },
    {
      "id": "time_holiday",
      "category": "time",
      "priority": 70,
      "headlineCondition": "holiday",
      "bodyFragmentTemplate": null,
      "fragmentOrder": 99,
      "conditionSource": "(rawData, insights, context) => { const date = context?.date; const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; return openTrails > 0 && isHoliday(date); }"
    },
    {
      "id": "grooming_good",
      "category": "terrain",
      "priority": 68,
      "headlineCondition": "grooming_highlight",
      "bodyFragmentTemplate": "{groomedCount} {groomedRunWord} groomed overnight. Fresh corduroy calling in {zones}.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const count = rawData.terrain?.newlyGroomed?.length || 0; const tier = getGroomingTier(count); return tier && tier.key === 'good'; }"
    },
    {
      "id": "time_busy_period",
      "category": "time",
      "priority": 65,
      "headlineCondition": null,
      "bodyFragmentTemplate": null,
      "fragmentOrder": 99,
      "conditionSource": "(rawData, insights, context) => { const date = context?.date; const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; // Only fire if it's a busy period but NOT a specific holiday (holiday rule is higher priority) return openTrails > 0 && isBusyPeriod(date) && !isHoliday(date); }"
    },
    {
      "id": "snow_holding_strong",
      "category": "snow",
      "priority": 60,
      "headlineCondition": "holding_strong",
      "bodyFragmentTemplate": "No fresh overnight, but {snow7day}\" in the past week is keeping things lively.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const snow24h = rawData.snow?.['24hour_inches'] || 0; const snow7day = rawData.snow?.['7day_inches'] || 0; return snow24h === 0 && snow7day >= 12; }"
    },
    {
      "id": "terrain_few",
      "category": "terrain",
      "priority": 60,
      "headlineCondition": "terrain_few",
      "bodyFragmentTemplate": "{newTrailsCount} more {newTrailWord} opened today, expanding your options.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const delta = rawData.terrain?.stats?.openTrails?.delta || 0; const tier = getTerrainTier(delta); return tier && tier.key === 'few'; }"
    },
    {
      "id": "lift_moderate",
      "category": "lifts",
      "priority": 60,
      "headlineCondition": null,
      "bodyFragmentTemplate": "Watch for crowds at {busiestLift}, which saw {maxWait}-minute waits yesterday.",
      "fragmentOrder": 2,
      "conditionSource": "(rawData) => { if (!isValidLiftData(rawData)) return false; const maxWait = rawData.lifts?.yesterday?.maxWaitTime || 0; return maxWait > 8 && maxWait <= 15; }"
    },
    {
      "id": "grooming_moderate",
      "category": "terrain",
      "priority": 55,
      "headlineCondition": null,
      "bodyFragmentTemplate": "{groomedCount} {groomedRunWord} freshly groomed, mostly in {zones}.",
      "fragmentOrder": 2,
      "conditionSource": "(rawData) => { const count = rawData.terrain?.newlyGroomed?.length || 0; const tier = getGroomingTier(count); return tier && tier.key === 'moderate'; }"
    },
    {
      "id": "forecast_snow_coming",
      "category": "weather",
      "priority": 55,
      "headlineCondition": "snow_coming",
      "bodyFragmentTemplate": "Snow showers in the forecast with a few inches expected.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData) => { const total = getForecastSnowTotal(rawData); const tier = getForecastTier(total); return tier && tier.key === 'snow_coming'; }"
    },
    {
      "id": "temp_cold",
      "category": "weather",
      "priority": 55,
      "headlineCondition": null,
      "bodyFragmentTemplate": "Cold day ahead: {tempHigh}° high. Dress warmly.",
      "fragmentOrder": 2,
      "conditionSource": "(rawData) => { const temp = rawData.forecast?.today?.high_f; if (temp === null || temp === undefined) return false; const tier = getTempTier(temp); return tier && tier.key === 'cold'; }"
    },
    {
      "id": "temp_unseasonably_warm",
      "category": "weather",
      "priority": 55,
      "headlineCondition": "unseasonably_warm",
      "bodyFragmentTemplate": "Unseasonably warm: {tempHigh}° today. Snow may soften by afternoon.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData, insights, context) => { const temp = rawData.forecast?.today?.high_f; const date = context?.date; return temp !== null && temp !== undefined && isUnseasonablyWarm(date, temp); }"
    },
    {
      "id": "time_weekend_kickoff",
      "category": "time",
      "priority": 52,
      "headlineCondition": "weekend_kickoff",
      "bodyFragmentTemplate": null,
      "fragmentOrder": 99,
      "conditionSource": "(rawData, insights, context) => { const dayOfWeek = context?.dayOfWeek || ''; const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; const date = context?.date; // Don't fire on holidays - holiday rule handles those return openTrails > 0 && dayOfWeek === 'Friday' && !isHoliday(date); }"
    },
    {
      "id": "temp_spring",
      "category": "weather",
      "priority": 50,
      "headlineCondition": "spring_vibes",
      "bodyFragmentTemplate": "Spring skiing conditions: {tempHigh}° and soft snow. Hit it early or catch the afternoon corn.",
      "fragmentOrder": 1,
      "conditionSource": "(rawData, insights, context) => { const temp = rawData.forecast?.today?.high_f; if (temp === null || temp === undefined || temp < 45) return false; const month = getMonth(context?.date); // March (2) or April (3) only return month === 2 || month === 3; }"
    },
    {
      "id": "lift_mellow",
      "category": "lifts",
      "priority": 50,
      "headlineCondition": null,
      "bodyFragmentTemplate": "Lift lines were mellow yesterday. Expect a similar vibe today.",
      "fragmentOrder": 2,
      "conditionSource": "(rawData) => { if (!isValidLiftData(rawData)) return false; const avgWait = rawData.lifts?.yesterday?.avgWaitTime || 0; return avgWait > 0 && avgWait < 4; }"
    },
    {
      "id": "terrain_micro",
      "category": "terrain",
      "priority": 45,
      "headlineCondition": null,
      "bodyFragmentTemplate": "{newTrailsCount} new {newTrailWord} opened today.",
      "fragmentOrder": 3,
      "conditionSource": "(rawData) => { const delta = rawData.terrain?.stats?.openTrails?.delta || 0; const tier = getTerrainTier(delta); return tier && tier.key === 'micro'; }"
    },
    {
      "id": "weather_windy",
      "category": "weather",
      "priority": 45,
      "headlineCondition": null,
      "bodyFragmentTemplate": "Windy conditions expected. Upper lifts may have holds or delays.",
      "fragmentOrder": 2,
      "conditionSource": "(rawData) => { return isWindy(rawData) && !rawData.forecast?.today?.description?.toLowerCase().includes('snow'); }"
    },
    {
      "id": "time_midweek_mellow",
      "category": "time",
      "priority": 45,
      "headlineCondition": "midweek_mellow",
      "bodyFragmentTemplate": null,
      "fragmentOrder": 99,
      "conditionSource": "(rawData, insights, context) => { const dayOfWeek = context?.dayOfWeek || ''; const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; const date = context?.date; // Only fire if NOT a holiday/busy period if (isBusyPeriod(date)) return false; return openTrails > 0 && ['Tuesday', 'Wednesday', 'Thursday'].includes(dayOfWeek); }"
    },
    {
      "id": "percent_full",
      "category": "terrain",
      "priority": 45,
      "headlineCondition": "percent_full",
      "bodyFragmentTemplate": null,
      "fragmentOrder": 99,
      "conditionSource": "(rawData) => { const pct = getPercentOpen(rawData); return pct >= 95; }"
    },
    {
      "id": "snow_week_total",
      "category": "snow",
      "priority": 40,
      "headlineCondition": null,
      "bodyFragmentTemplate": "Steady snowfall with {snow7day}\" over the last week.",
      "fragmentOrder": 2,
      "conditionSource": "(rawData) => { const snow7day = rawData.snow?.['7day_inches'] || 0; return snow7day >= 6 && snow7day < 12; }"
    },
    {
      "id": "time_saturday",
      "category": "time",
      "priority": 38,
      "headlineCondition": "saturday",
      "bodyFragmentTemplate": null,
      "fragmentOrder": 99,
      "conditionSource": "(rawData, insights, context) => { const dayOfWeek = context?.dayOfWeek || ''; const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; const date = context?.date; return openTrails > 0 && dayOfWeek === 'Saturday' && !isHoliday(date); }"
    },
    {
      "id": "time_sunday",
      "category": "time",
      "priority": 38,
      "headlineCondition": "sunday",
      "bodyFragmentTemplate": null,
      "fragmentOrder": 99,
      "conditionSource": "(rawData, insights, context) => { const dayOfWeek = context?.dayOfWeek || ''; const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; const date = context?.date; return openTrails > 0 && dayOfWeek === 'Sunday' && !isHoliday(date); }"
    },
    {
      "id": "forecast_flurries",
      "category": "weather",
      "priority": 30,
      "headlineCondition": null,
      "bodyFragmentTemplate": "Light snow possible in the forecast.",
      "fragmentOrder": 2,
      "conditionSource": "(rawData) => { const total = getForecastSnowTotal(rawData); const tier = getForecastTier(total); return tier && tier.key === 'flurries'; }"
    },
    {
      "id": "percent_early",
      "category": "context",
      "priority": 15,
      "headlineCondition": "early_season",
      "bodyFragmentTemplate": "Early season conditions with {openTrails} of {totalTrails} trails open.",
      "fragmentOrder": 99,
      "conditionSource": "(rawData, insights, context) => { const pct = getPercentOpen(rawData); const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; return openTrails > 0 && pct < 30; }"
    },
    {
      "id": "fallback_headline",
      "category": "snow",
      "priority": 10,
      "headlineCondition": "fallback",
      "bodyFragmentTemplate": null,
      "fragmentOrder": 99,
      "conditionSource": "() => true"
    },
    {
      "id": "fallback_body",
      "category": "weather",
      "priority": 5,
      "headlineCondition": null,
      "bodyFragmentTemplate": "{openTrails}/{totalTrails} trails open, {groomedTrails} groomed. {tempHigh}° and {weatherToday}.",
      "fragmentOrder": 99,
      "conditionSource": "(rawData) => { const openTrails = rawData.terrain?.stats?.openTrails?.today || 0; const snow24h = rawData.snow?.['24hour_inches'] || 0; const snow7day = rawData.snow?.['7day_inches'] || 0; const hasTerrainChanges = (rawData.terrain?.stats?.openTrails?.delta || 0) > 0; const hasGrooming = (rawData.terrain?.newlyGroomed?.length || 0) > 5; const hasLiftData = isValidLiftData(rawData) && rawData.lifts?.yesterday?.avgWaitTime > 0; // Don't fire if resort is closed if (openTrails === 0) return false; // If none of the notable conditions are true, fire the fallback return snow24h === 0 && snow7day < 6 && !hasTerrainChanges && !hasGrooming && !hasLiftData; }"
    }
  ]
}